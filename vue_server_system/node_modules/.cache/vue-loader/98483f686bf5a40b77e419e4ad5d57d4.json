{"remainingRequest":"D:\\vue_workspace\\vue_server_system\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue_workspace\\vue_server_system\\src\\views\\Login.vue?vue&type=style&index=0&id=26084dc2&scoped=true&lang=css&","dependencies":[{"path":"D:\\vue_workspace\\vue_server_system\\src\\views\\Login.vue","mtime":1684314372380},{"path":"D:\\vue_workspace\\vue_server_system\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue_workspace\\vue_server_system\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\vue_workspace\\vue_server_system\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\vue_workspace\\vue_server_system\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue_workspace\\vue_server_system\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouZWwtcm93IHsNCiAgYmFja2dyb3VuZDogI2ZhZmFmYTsNCiAgaGVpZ2h0OiAxMDAlOw0KDQogIGRpc3BsYXk6IGZsZXg7DQogIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICBhbGlnbi1pdGVtczogY2VudGVyOw0KDQogIHRleHQtYWxpZ246IGNlbnRlcjsNCn0NCg0KLmVsLWRpdmlkZXIgew0KICBoZWlnaHQ6IDIwMHB4Ow0KfQ0KDQouY2FwdGNoYUltZyB7DQogIGZsb2F0OiBsZWZ0Ow0KICBtYXJnaW4tbGVmdDogMTBweDsNCiAgYm9yZGVyLXJhZGl1czogNHB4Ow0KfQ0KDQo="},{"version":3,"sources":["Login.vue"],"names":[],"mappings":";AA2HA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <el-row>\r\n    <el-col :xl=\"6\" :lg=\"7\" :xs=\"24\">\r\n      <h2>欢迎使用万里学院影院APP后台系统</h2>\r\n      <el-image style=\"width: 200px;height: 180px;\" :src=\"require('@/assets/logo.png')\"></el-image>\r\n      <p>万里学院大数据与软件工程专业提供技术支持</p>\r\n      <p>基于java基础实现</p>\r\n    </el-col>\r\n    <el-col :span=\"1\">\r\n      <el-divider direction=\"vertical\"></el-divider>\r\n    </el-col>\r\n    <el-col :xl=\"6\" :lg=\"7\">\r\n      <el-form ref=\"loginForm\" :model=\"loginForm\" label-width=\"80px\" label-position=\"right\" :rules=\"rules\">\r\n        <el-form-item label=\"用户名\" style=\"width: 380px\" prop=\"username\">\r\n          <el-input v-model=\"loginForm.username\"></el-input>\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"密码\" style=\"width: 380px\" prop=\"password\">\r\n          <el-input type=\"password\" v-model=\"loginForm.password\"></el-input>\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"验证码\" style=\"width: 380px\" prop=\"code\">\r\n          <el-input v-model=\"loginForm.code\" style=\"width: 170px;float: left;\" maxlength=\"5\"></el-input>\r\n          <el-image :src=\"captchaImg\" class=\"captchaImg\" @click=\"getCaptcha\"></el-image>\r\n        </el-form-item>\r\n\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"$event=>submitForm('loginForm')\">提交</el-button>\r\n          <el-button>获取密码</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-col>\r\n  </el-row>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      key:'',\r\n      captchaImg: '',\r\n      loginForm: {\r\n        username: '',\r\n        password: '',\r\n        code: '',\r\n        token: '',\r\n        key:'',\r\n      },\r\n      rules: {\r\n        username:\r\n            [\r\n          //非空验证\r\n          {required: true, message: '请输入登录的用户名', trigger: 'blur'}],\r\n        password: [{required: true, message: '请输入登录的密码', trigger: 'blur'}],\r\n        code: [{required: true, message: '请输入验证码', trigger: 'blur'},\r\n          //字符长度的验证规则\r\n          {min: 5, max: 5, message: '验证码长度为 5 个字符', trigger: 'blur'}]\r\n      }\r\n    }\r\n  },\r\n  components: {},\r\n  props: {},\r\n  created() {\r\n    console.log('初始化')\r\n    this.getCaptcha()\r\n  },\r\n  methods: {\r\n    submitForm(formName) {\r\n\r\n      //fromName参数传递就是ref='loginFrom' 使用this.$refs[fromName]获得 页面上的表单。\r\n      this.$refs[formName].validate((valid) => {\r\n\r\n        //如果valid为true，表示表单的验证规则 通过。\r\n        if (valid) {\r\n\r\n          // alert('请求服务器登录')将js对象转换为参数形式字符串username=123$pwd=123\r\n          this.$axios.post('/login?'+this.$qs.stringify(this.loginForm))\r\n              .then(response=>{\r\n\r\n                //获得服务器返回token，在响应头中\r\n                const jwt=response.headers['token']\r\n                //保存jwt 调用Vuex中的mutations中的SET_TOKEN方法进行保存。\r\n                this.$store.commit('SET_TOKEN',jwt)\r\n                //跳转至首页\r\n                 this.$setSessionStorage('username',this.loginForm.username)\r\n                console.log(\"登陆成功\")\r\n                 this.$router.push('/index')\r\n              })\r\n              .catch(error=>{\r\n                console.log(error)\r\n                //如果登录发生异常，刷新验证码\r\n                this.getCaptcha()\r\n              })\r\n        } else {\r\n          console.log('error submit!');\r\n          return false;\r\n        }\r\n      })\r\n    },\r\n    getCaptcha(){\r\n      //用axios请求服务器获得验证码数据\r\n      //get(路径) 请求服务器\r\n      //then 服务器响应成功回调函数\r\n\r\n      this.$axios.get('/captcha')\r\n      .then((response)=>{\r\n\r\n        console.log(response.data)\r\n        this.captchaImg=response.data.resultdata.captchaImg\r\n        this.loginForm.key=response.data.resultdata.key\r\n      }).catch((error)=>{\r\n        console.log(error)\r\n      })\r\n\r\n\r\n    }\r\n  },\r\n\r\n\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.el-row {\r\n  background: #fafafa;\r\n  height: 100%;\r\n\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n\r\n  text-align: center;\r\n}\r\n\r\n.el-divider {\r\n  height: 200px;\r\n}\r\n\r\n.captchaImg {\r\n  float: left;\r\n  margin-left: 10px;\r\n  border-radius: 4px;\r\n}\r\n\r\n</style>"]}]}