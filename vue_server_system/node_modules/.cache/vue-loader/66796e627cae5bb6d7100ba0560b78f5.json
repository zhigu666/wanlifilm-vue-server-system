{"remainingRequest":"D:\\desk\\vue_server_system\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\desk\\vue_server_system\\src\\views\\Login.vue?vue&type=style&index=0&id=26084dc2&scoped=true&lang=css&","dependencies":[{"path":"D:\\desk\\vue_server_system\\src\\views\\Login.vue","mtime":1684828296563},{"path":"D:\\desk\\vue_server_system\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\desk\\vue_server_system\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\desk\\vue_server_system\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\desk\\vue_server_system\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\desk\\vue_server_system\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouZWwtcm93ew0KICBiYWNrZ3JvdW5kOiAjZmFmYWZhOw0KICBoZWlnaHQ6IDEwMCU7DQoNCiAgZGlzcGxheTogZmxleDsNCiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQoNCiAgdGV4dC1hbGlnbjogY2VudGVyOw0KfQ0KDQouZWwtZGl2aWRlcnsNCiAgaGVpZ2h0OiAyMDBweDsNCn0NCi5jYXB0Y2hhSW1new0KICBmbG9hdDpsZWZ0Ow0KICBtYXJnaW4tbGVmdDoxMHB4Ow0KICBib3JkZXItcmFkaXVzOjRweDsNCn0NCg=="},{"version":3,"sources":["Login.vue"],"names":[],"mappings":";AAgIA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n    <el-row>\r\n     \r\n      <el-col :xl=\"6\" :lg=\"7\" :xs=\"24\">\r\n        <h2>欢迎使用万里学院影院App后台管理系统</h2>\r\n        <el-image style=\"width:180px; height: 180px; border-radius: 16px;\" :src=\"require('@/assets/logo.jpg')\">\r\n        </el-image>\r\n        <p>万里学院大数据与软件工程专业提供技术支持</p>\r\n        <p>基于SpringBoot技术实现</p>\r\n      </el-col>\r\n      <el-col :span=\"1\">\r\n        <!-- 分割线 -->\r\n        <el-divider direction=\"vertical\"></el-divider>\r\n      </el-col>\r\n      <el-col :xl=\"6\" :lg=\"7\">\r\n        <!-- ref就类似于 html标签 标记所定义id='loginForm' 可用在JS代码中 通过ref获得标签 -->\r\n        <el-form ref=\"loginForm\" :model=\"loginForm\" label-width=\"80px\" label-position=\"right\" :rules=\"rules\">\r\n          <el-form-item label=\"用户名\" style=\"width:380px\" prop=\"username\">\r\n            <el-input v-model=\"loginForm.username\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"密码\" style=\"width:380px\" prop=\"password\">\r\n            <el-input type=\"password\" v-model=\"loginForm.password\"></el-input>\r\n          </el-form-item>\r\n\r\n          <el-form-item label=\"验证码\" style=\"width:380px\" prop=\"code\">\r\n            <el-input  v-model=\"loginForm.code\" style=\"width: 170px; float:left;\" maxlength=\"5\"></el-input>\r\n            <el-image :src=\"captchaImg\" class=\"captchaImg\" @click=\"getCaptcha\"></el-image>\r\n          </el-form-item>\r\n\r\n          <el-form-item>\r\n             <el-button type=\"primary\" @click=\"submitForm('loginForm')\">提交</el-button>\r\n              <el-button >获取密码</el-button>\r\n          </el-form-item>\r\n        </el-form>  \r\n      </el-col>\r\n    </el-row>\r\n</template>\r\n\r\n<script>\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      captchaImg:'',  //验证码图片的数据\r\n      loginForm: {\r\n        username: '',\r\n        password: '',\r\n        code: '',   //验证码   存redis中的value\r\n        key:''     //随机码   存redis中的key\r\n      },\r\n      //验证规则 rules\r\n      rules: {\r\n        username: [\r\n          //非空验证\r\n          {required:true,message:'请输入登录的用户名',trigger:'blur'}\r\n        ],\r\n        password: [\r\n          {required:true,message:'请输入登录的密码',trigger:'blur'}\r\n        ],\r\n        code: [\r\n          { required: true, message: '请输入验证码', trigger: 'blur' },\r\n          //字符长度的验证规则\r\n          {min:5,max:5,message:'验证码长度为 5 个字符',trigger:'blur'}\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  created () { \r\n    //Vue实例的生命周期方法，创建完毕\r\n    this.getCaptcha();\r\n  },\r\n  methods: {\r\n    submitForm (fromName) { \r\n      //fromName参数传递就是ref='loginFrom'   使用this.$refs[fromName]获得页面上的表单。\r\n      this.$refs[fromName].validate((valid) => { \r\n        //如果valid为true，表示表单的验证规则 通过。\r\n        if (valid) {\r\n          //post(路径,参数值)\r\n          //this.$qs.stringify( JS对象)  将js对象转换为 参数形式字符串。 username=admin&password=123&key=123123&code=5w3qw\r\n          this.$axios.post('/login?'+this.$qs.stringify(this.loginForm))\r\n            .then(response => {  \r\n                //获得服务器返回token，在响应头中。 jwt\r\n                const jwt = response.headers['token']\r\n                //保存jwt 调用Vuex中的mutations中的SET_TOKEN方法进行保存。\r\n                this.$store.commit('SET_TOKEN', jwt)\r\n                //调换至首页。 \r\n                this.$setSessionStorage('username',this.loginForm.username)\r\n                console.log(\"登录操作成功\");\r\n                this.$router.push('/home')\r\n                //this.$router.push({ name: 'Index', params: { name: '222' } })\r\n            })\r\n            this.getCaptcha()\r\n        } else {    \r\n          this.getCaptcha()\r\n          console.log('Error Submit!');\r\n          return false;\r\n        }\r\n      })\r\n    },\r\n    //请求服务器获得验证码图片数据\r\n    getCaptcha () { \r\n      //使用axios请求服务器获得验证码数据:\r\n      //get(路径)  请求服务器\r\n      //then  服务器响应成功的回调函数.\r\n      this.$axios.get('/captcha')\r\n        .then(response => { \r\n          console.log(response.data);\r\n          this.captchaImg = response.data.resultdata.captchaImg\r\n          this.loginForm.key = response.data.resultdata.key\r\n        }).catch(error => { \r\n          console.log(error);\r\n        })\r\n\r\n      /*\r\n         服务器返回的数据格式：\r\n         response.data就是服务器返回的数据对象:\r\n         {\r\n          code: 200, //200请求操作成功\r\n          message: '操作成功',\r\n          resultdata: {key:随机码,captchaImg:转码后验证码图片}, //data就是具体请求的数据\r\n        }\r\n      */\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.el-row{\r\n  background: #fafafa;\r\n  height: 100%;\r\n\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n\r\n  text-align: center;\r\n}\r\n\r\n.el-divider{\r\n  height: 200px;\r\n}\r\n.captchaImg{\r\n  float:left;\r\n  margin-left:10px;\r\n  border-radius:4px;\r\n}\r\n</style>\r\n"]}]}